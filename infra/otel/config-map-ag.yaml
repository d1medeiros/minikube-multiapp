#apiVersion: v1
#kind: ConfigMap
#metadata:
#  name: otel-agent-conf
#  namespace: monitoring
#  labels:
#    app: opentelemetry
#    component: otel-agent-conf
#data:
#  otel-agent-config: |
#    receivers:
#      otlp:
#        protocols:
#          grpc:
#          http:
#      hostmetrics:
#        scrapers:
#          cpu:
#          disk:
#          filesystem:
#          load:
#          memory:
#          network:
#          process:
#          processes:
#          paging:
#    exporters:
#      otlp:
#        endpoint: otel-collector.monitoring:4317
#        tls:
#          insecure: true
#        sending_queue:
#          num_consumers: 4
#          queue_size: 100
#        retry_on_failure:
#          enabled: true
#    processors:
#      batch:
#      memory_limiter:
#        # 80% of maximum memory up to 2G
#        limit_mib: 400
#        # 25% of limit up to 2G
#        spike_limit_mib: 100
#        check_interval: 5s
#    extensions:
#      zpages: {}
#      memory_ballast:
#        # Memory Ballast size should be max 1/3 to 1/2 of memory.
#        size_mib: 165
#    service:
#      extensions: [zpages, memory_ballast]
#      pipelines:
#        metrics:
#          receivers: [otlp, hostmetrics]
#          processors: [memory_limiter, batch]
#          exporters: [otlp]
